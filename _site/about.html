<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>About – Hridika Shah</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Hridika Shah</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./about.html" aria-current="page"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./example-analysis.html"> 
<span class="menu-text">Example Analysis</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#education" id="toc-education" class="nav-link active" data-scroll-target="#education">EDUCATION</a></li>
  <li><a href="#academicprofessional-experience" id="toc-academicprofessional-experience" class="nav-link" data-scroll-target="#academicprofessional-experience">ACADEMIC/PROFESSIONAL EXPERIENCE</a></li>
  <li><a href="#publications-and-presentations" id="toc-publications-and-presentations" class="nav-link" data-scroll-target="#publications-and-presentations">PUBLICATIONS AND PRESENTATIONS</a>
  <ul class="collapse">
  <li><a href="#peer-reviewed-publications" id="toc-peer-reviewed-publications" class="nav-link" data-scroll-target="#peer-reviewed-publications">Peer-reviewed publications</a></li>
  <li><a href="#non-peer-reviewed-publications" id="toc-non-peer-reviewed-publications" class="nav-link" data-scroll-target="#non-peer-reviewed-publications">Non-peer reviewed publications</a></li>
  <li><a href="#presentations" id="toc-presentations" class="nav-link" data-scroll-target="#presentations">Presentations</a></li>
  <li><a href="#works-in-progress" id="toc-works-in-progress" class="nav-link" data-scroll-target="#works-in-progress">Works in progress</a></li>
  </ul></li>
  <li><a href="#skills" id="toc-skills" class="nav-link" data-scroll-target="#skills">SKILLS</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">About</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="education" class="level2">
<h2 class="anchored" data-anchor-id="education">EDUCATION</h2>
<p><strong>Johns Hopkins Bloomberg School of Public Health, Baltimore, MD</strong><br>
Doctor of Philosophy in Health Policy | Expected 2028</p>
<p><strong>Johns Hopkins Bloomberg School of Public Health, Baltimore, MD</strong><br>
Master of Science in Public Health in Health Policy | 2024<br>
Certificate in Public Health Economics | 2024</p>
<p><strong>Johns Hopkins University, Baltimore, MD</strong><br>
Bachelor of Arts in Public Health and Economics | 2022</p>
</section>
<section id="academicprofessional-experience" class="level2">
<h2 class="anchored" data-anchor-id="academicprofessional-experience">ACADEMIC/PROFESSIONAL EXPERIENCE</h2>
<p>Senior Research Program Coordinator | Johns Hopkins Bloomberg School of Public Health<br>
June 2023-June 2024 | Baltimore, MD</p>
<ul>
<li>Liaised with partners to coordinate Bloomberg Overdose Prevention Initiative projects in Michigan.</li>
<li>Contributed to the authoring, review, and revision of manuscripts, reports, and presentations.</li>
<li>Collaboratively developed research plans and study instruments for submission to the IRB.</li>
<li>Recruited and conducted qualitative interviews for a study evaluating the impact of COVID-19 housing policies among people who use drugs.</li>
</ul>
<p>Teaching Assistant | Johns Hopkins Bloomberg School of Public Health<br>
August 2023-May 2024 | Baltimore, MD</p>
<ul>
<li>Economic Evaluation I (Term 1), Research and Evaluation Methods for Health Policy (Term 3), Housing Insecurity and Health (Term 4)</li>
<li>Assisted in grading assignments and providing constructive feedback to graduate students.</li>
<li>Managed student correspondence and other non-instructional duties to support faculty.</li>
</ul>
<p>Undergraduate &amp; Graduate Intern, Bloomberg Overdose Prevention Initiative<br>
January 2020-May 2023 | Baltimore, MD</p>
<ul>
<li>Conducted literature reviews and composed policy memos on telemedicine regulations, opioid settlement funds, and medications for opioid use disorder prescribing laws.</li>
<li>Prepared, cleaned, and visualized quantitative survey data on opioid use disorder in New Jersey jails and presented analyses to state health officials.</li>
<li>Provide mentorship to current undergraduate project interns.</li>
</ul>
<p>Graduate Research Assistant in Department of Mental Health, Johns Hopkins Bloomberg School of Public Health<br>
June 2022-May 2023 | Baltimore, MD</p>
<ul>
<li>Conceptualized and performed legal mapping of state SNAP policies between 2000 and 2021.</li>
<li>Formulated and produced literature reviews of peer-reviewed and grey literature on the impacts of state SNAP policies on participant health outcomes.</li>
</ul>
<p>Harm Reduction Policy Intern, Atlanta Harm Reduction Coalition<br>
May 2022-August 2022 | Atlanta, GA</p>
<ul>
<li>Surveyed clients for community need assessment and assisted with weekly community outreach.</li>
<li>Assisted in writing grant proposals, conducting analyses, and developing reports.</li>
<li>Investigated data and authored pamphlets on drug paraphernalia and Good Samaritan laws.</li>
</ul>
<p>Health &amp; Benefits Consulting Intern, Mercer, Marsh, &amp; McLennan Companies<br>
June 2021-December 2021 | Atlanta, GA</p>
<ul>
<li>Analyzed health care claims, utilization data, and cost projections for health insurance plans.</li>
<li>Supported senior consultants in reviewing client needs strategies for health and benefits packages.</li>
</ul>
</section>
<section id="publications-and-presentations" class="level2">
<h2 class="anchored" data-anchor-id="publications-and-presentations">PUBLICATIONS AND PRESENTATIONS</h2>
<section id="peer-reviewed-publications" class="level3">
<h3 class="anchored" data-anchor-id="peer-reviewed-publications">Peer-reviewed publications</h3>
<ol type="1">
<li><p>Shah H. Bandara A, McCourt AD. Laws Limiting Access to SNAP Benefits for People with Felony Drug Convictions: A Policy Mapping Study. Am J Public Health. In Press.</p></li>
<li><p>Heidari O, Shah H, Bhagwat A, Ahmad NJ, Whaley S, Sherman SG, Morris M, Saloner B. Changes in opioid treatment programs and harm reduction provider services during the COVID-19 pandemic: Findings from 10 states. Psychol Serv. 2023 Oct 12. doi: 10.1037/ser0000805. Epub ahead of print.</p></li>
<li><p>Sugarman OK, Shah H, Whaley S, McCourt A, Saloner B, Bandara S. Examining policy responses to xylazine in the drug supply: A legal policy content analysis. Int. J Drug Policy. 2024 July 1;129:104472. doi: 10.1016/j.drugpo.2024.104472.</p></li>
<li><p>Song M, Desai IK, Meyer A, Shah H, Saloner B, Sherman SG, Allen ST, Tomko C, Schneider KE, Krawczyk N, Whaley S, Churchill J, Harris SJ. Exploring trauma and wellbeing of people who use drugs after witnessing overdose: A qualitative study. Int J Drug Policy. 2023 Oct 25;122:104239. doi: 10.1016/j.drugpo.2023.104239.</p></li>
<li><p>Krawczyk N, Bandara S, Merritt S, Shah H, Duncan A, McEntee B, Schiff M, Ahmad NJ, Whaley S, Latimore A, Saloner B. Jail-based treatment for opioid use disorder in the era of bail reform: a qualitative study of barriers and facilitators to implementation of a state-wide medication treatment initiative. Addict Sci Clin Pract. 2022 Jun 2;17(1):30. doi: 10.1186/s13722-022-00313-6.</p></li>
<li><p>Krawczyk N, Allen ST, Schneider KE, Solomon K, Shah H, Morris M, Harris SJ, Sherman SG, Saloner B. Intersecting substance use treatment and harm reduction services: exploring the characteristics and service needs of a community-based sample of people who use drugs. Harm Reduct J. 2022 Aug 24;19(1):95. doi: 10.1186/s12954-022-00676-8.</p></li>
<li><p>Feder KA, Harris SJ, Byrne L, Miller SM, Sodder S, Berman V, Livingston A, Edwards J, Hartman S, Sugarman OK, Shah H, Xu J, Raikes J, Gattine S, Saloner B. Attitudes and beliefs about Vermont’s 2021 buprenorphine decriminalization law among residents who use illicit opioids. Drug Alcohol Depend. 2023 Sep 1;250:110879. doi: 10.1016/j.drugalcdep.2023.110879.</p></li>
</ol>
</section>
<section id="non-peer-reviewed-publications" class="level3">
<h3 class="anchored" data-anchor-id="non-peer-reviewed-publications">Non-peer reviewed publications</h3>
<ol type="1">
<li><p>Sugarman OK, Shah H, Whaley S. Tracking “Tranq” Laws: The state of policy responses to the growing xylazine crisis. Opioid Principles. Published August 30, 2023. Available at: https://opioidprinciples.jhsph.edu/tracking-tranq-laws-the-state-of-policy-responses-to-the-growing-xylazine-crisis/. [Working paper].</p></li>
<li><p>Larweh H and Shah H. Pharmacist and Prescriber Perceptions on Buprenorphine Prescribing and Dispensing. Published May 22, 2024. Available at: https://opioidprinciples.jhsph.edu/pharmacist-and-prescriber-perceptions-on-buprenorphine-prescribing-and-dispensing/.</p></li>
<li><p>Harris SJ, Meyer A, Whaley S, Bhagwat A, Shah H, Sherman SG, Allen ST, Saloner, B. In Their Own Words: Experiences of People Who Use Drugs During the COVID-19 Pandemic. Published March 17, 2022. Available at: https://americanhealth.jhu.edu/news/new-report-shares-perspectives-people-who-use-drugs-during-pandemic.</p></li>
</ol>
</section>
<section id="presentations" class="level3">
<h3 class="anchored" data-anchor-id="presentations">Presentations</h3>
<ol type="1">
<li><p>Shah H, Whaley S, Ahmad NJ, Patel E, Kim E, Bhagwat A, Maniates H, Merritt S, Bandara S, Krawczyk N, Heidari O. Interventions for Co-use of Opioids and Methamphetamine: A Scoping Review. NYU Langone Health Polysubstance Use Symposium. Oral Presentation (October 2022).</p></li>
<li><p>Shah H. Bandara A, McCourt AD. Laws Limiting Access to SNAP Benefits for People with Felony Drug Convictions: A Policy Mapping Study. American Public Health Association (APHA) Annual Meeting. Roundtable Presentation (November 2023).</p></li>
<li><p>Harris SJ, Meyer A, Shah H, Song M, Desai IK, Krawczyk N, Allen ST, Sherman SG, Saloner B. Narratives of Engaging in Emergency Services, Drug Treatment, and Harm Reduction Services following Nonfatal Overdose in the COVID-19 Pandemic Across States. Academy Health Annual Research Meeting. (June 2023).</p></li>
<li><p>Harris SJ, Meyer A, Song M, Desai IK, Shah H, Sherman SG, Saloner B. Utilization of harm reduction services following nonfatal overdose events during the COVID-19 pandemic in the United States: Results from a cohort study of overdose survivors. International AIDS Conference. (July 2022).</p></li>
</ol>
</section>
<section id="works-in-progress" class="level3">
<h3 class="anchored" data-anchor-id="works-in-progress">Works in progress</h3>
<ol type="1">
<li><p>Shah H, Meyer A, Song M, Desai IK, Whaley S, Heidari O, Allen ST, Krawczyk N, Sherman SG, Saloner B, Harris SJ. “That’s the recipe for me, I relapsed”: A Qualitative Study on the Impact of COVID-19 on Overdose Mortality from the Perspective of Survivors and Witnesses of Drug Overdose. [Under Review].</p></li>
<li><p>O Heidari, K Feder, H Shah, I Desai, E Yeung, J Xu. Evaluation of Emergency Medical System and Social Work Co-Response to Opioid Overdoses. [Under Review].</p></li>
<li><p>Gibbons JB, Sugarman OK, Byrne L, Harris SJ, Shah H, Husley E, Rwan J, Rosner EM, Pantaleo A, Bergquist E, Saloner B. Michigan’s Naloxone Leave Behind Program: Perceptions of Emergency Medical Services Personnel. [Under Review].</p></li>
</ol>
</section>
</section>
<section id="skills" class="level2">
<h2 class="anchored" data-anchor-id="skills">SKILLS</h2>
<p>Statistical Programs &amp; Qualitative Software: R, Stata, ATLAS.ti, Dedoose Survey &amp; Data Management: Research Electronic Data Capture (REDCap), Qualtrics</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>